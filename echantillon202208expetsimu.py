import numpy as np
import matplotlib.pyplot as plt
Wavelength = np.arange(300, 420, 1)
from scipy.integrate import simps
from scipy.interpolate import make_interp_spline
from scipy.ndimage import gaussian_filter1d
from scipy.interpolate import make_interp_spline
from numpy import trapz
import numpy as np
import function as fct


R202208simu=np.array([11.682347  , 11.60549533, 11.52821024, 11.45141145, 11.37600237,
       11.3028548 , 11.23280815, 11.16664799, 11.1532495 , 11.15767259,
       11.16967086, 11.19086642, 11.21975866, 11.25651757, 11.30298003,
       11.3570198 , 11.41940336, 11.49083617, 11.56906957, 11.65678215,
       11.7516829 , 11.85361332, 11.96446275, 12.08034258, 12.20540316,
       12.33500331, 12.47251538, 12.61527327, 12.76414104, 12.91854346,
       13.0775458 , 13.24229689, 13.41076281, 13.58402111, 13.76001371,
       13.93959618, 14.12133998, 14.30434162, 14.48823373, 14.6709163 ,
       14.85173039, 15.02982855, 15.19954184, 15.36858174, 15.51663847,
       15.66339325, 15.78722828, 15.8995501 , 15.99726387, 16.06543277,
       16.13321184, 16.16484964, 16.19666842, 16.22626983, 16.25850978,
       16.31706546, 16.42256565, 16.59081332, 16.83473096, 17.20999719,
       17.68907135, 18.29199246, 19.01915567, 19.84489227, 20.73004108,
       21.63701003, 22.57233156, 23.42113318, 24.18469207, 24.90109062,
       25.44520796, 25.85083131, 26.17364573, 26.3354161 , 26.3531674 ,
       26.28821412, 26.11655529, 25.82891362, 25.47592484, 25.05992006,
       24.58007236, 24.05605929, 23.49134684, 22.92325442, 22.34386609,
       21.73937893, 21.12132655, 20.54240999, 19.94868185, 19.34260058,
       18.75439188, 18.18881317, 17.61772295, 17.04301475, 16.5009635 ,
       15.97263163, 15.44501769, 14.9195384 , 14.42788839, 13.94804227,
       13.47291625, 13.00356064, 12.56266467, 12.13615055, 11.7168297 ,
       11.30544698, 10.91438774, 10.54202064, 10.17826111,  9.82362156,
        9.48121756,  9.16155936,  8.85120253,  8.55048157,  8.25969814,
        7.98593342,  7.72585504,  7.47548573,  7.23498832,  7.0045172 ,
        6.79070818,  6.58697026,  6.39278371,  6.20818999,  6.03331097,
        5.87235453])
T202208simu=np.array([0.00000000e+000+0.00000000e+000j, 0.00000000e+000+0.00000000e+000j,
       0.00000000e+000+0.00000000e+000j, 2.63945967e-311+2.24309077e-313j,
       5.50553530e-280+4.24892181e-282j, 7.19527795e-251+5.02362030e-253j,
       7.64182070e-224+4.80642660e-226j, 7.35775671e-199+4.15066841e-201j,
       8.88498851e-176+4.47258950e-178j, 1.50385564e-154+6.71899095e-157j,
       4.74380589e-135+1.86953765e-137j, 3.18789632e-117+1.10078033e-119j,
       5.69961039e-101+1.71117112e-103j, 3.07006675e-086+7.94658592e-089j,
       6.43598773e-073+1.42189039e-075j, 6.16039150e-061+1.14822428e-063j,
       3.00556928e-050+4.66404733e-053j, 8.69497171e-041+1.10602430e-043j,
       1.80618669e-032+1.84762630e-035j, 3.10412043e-025+2.49420929e-028j,
       5.06974897e-019+3.10624264e-022j, 8.62159899e-014+3.88012383e-017j,
       1.81710312e-009+5.70374536e-013j, 5.16863855e-006+1.05319219e-009j,
       2.34368973e-003+2.76523915e-007j, 1.75819421e-001+9.96339802e-006j,
       2.67041897e+000+4.67539395e-005j, 8.47745679e+000+5.12537774e-006j,
       8.74576342e+000+0.00000000e+000j, 8.65986111e+000+0.00000000e+000j,
       8.57705425e+000+0.00000000e+000j, 8.50113054e+000+0.00000000e+000j,
       8.42968865e+000+0.00000000e+000j, 8.37106078e+000+0.00000000e+000j,
       8.31936428e+000+0.00000000e+000j, 8.28645916e+000+0.00000000e+000j,
       8.26449942e+000+0.00000000e+000j, 8.26756998e+000+0.00000000e+000j,
       8.29066478e+000+0.00000000e+000j, 8.34162470e+000+0.00000000e+000j,
       8.43141838e+000+0.00000000e+000j, 8.54359992e+000+0.00000000e+000j,
       8.73123640e+000+0.00000000e+000j, 8.92033804e+000+0.00000000e+000j,
       9.24795318e+000+0.00000000e+000j, 9.58483485e+000+0.00000000e+000j,
       1.00572034e+001+0.00000000e+000j, 1.06102836e+001+0.00000000e+000j,
       1.12601188e+001+0.00000000e+000j, 1.21152152e+001+0.00000000e+000j,
       1.30251871e+001+0.00000000e+000j, 1.42433447e+001+0.00000000e+000j,
       1.56015274e+001+0.00000000e+000j, 1.71700456e+001+0.00000000e+000j,
       1.90658391e+001+0.00000000e+000j, 2.11430047e+001+0.00000000e+000j,
       2.35360755e+001+0.00000000e+000j, 2.61922236e+001+0.00000000e+000j,
       2.90798624e+001+0.00000000e+000j, 3.21094225e+001+0.00000000e+000j,
       3.53717438e+001+0.00000000e+000j, 3.86879344e+001+0.00000000e+000j,
       4.18923926e+001+0.00000000e+000j, 4.52605742e+001+0.00000000e+000j,
       4.83457058e+001+0.00000000e+000j, 5.11912629e+001+0.00000000e+000j,
       5.41416357e+001+0.00000000e+000j, 5.66006632e+001+0.00000000e+000j,
       5.88307863e+001+0.00000000e+000j, 6.11593510e+001+0.00000000e+000j,
       6.30262581e+001+0.00000000e+000j, 6.46896785e+001+0.00000000e+000j,
       6.64587179e+001+0.00000000e+000j, 6.79188413e+001+0.00000000e+000j,
       6.91431385e+001+0.00000000e+000j, 7.04628588e+001+0.00000000e+000j,
       7.16567643e+001+0.00000000e+000j, 7.25408361e+001+0.00000000e+000j,
       7.34960232e+001+0.00000000e+000j, 7.44903365e+001+0.00000000e+000j,
       7.51033549e+001+0.00000000e+000j, 7.57615482e+001+0.00000000e+000j,
       7.64616400e+001+0.00000000e+000j, 7.70767456e+001+0.00000000e+000j,
       7.76561339e+001+0.00000000e+000j, 7.82606211e+001+0.00000000e+000j,
       7.88786735e+001+0.00000000e+000j, 7.94575900e+001+0.00000000e+000j,
       8.00513181e+001+0.00000000e+000j, 8.06573994e+001+0.00000000e+000j,
       8.12456081e+001+0.00000000e+000j, 8.18111868e+001+0.00000000e+000j,
       8.23822770e+001+0.00000000e+000j, 8.29569852e+001+0.00000000e+000j,
       8.34990365e+001+0.00000000e+000j, 8.40273684e+001+0.00000000e+000j,
       8.45549823e+001+0.00000000e+000j, 8.50804616e+001+0.00000000e+000j,
       8.55721116e+001+0.00000000e+000j, 8.60519577e+001+0.00000000e+000j,
       8.65270838e+001+0.00000000e+000j, 8.69964394e+001+0.00000000e+000j,
       8.74373353e+001+0.00000000e+000j, 8.78638494e+001+0.00000000e+000j,
       8.82831703e+001+0.00000000e+000j, 8.86945530e+001+0.00000000e+000j,
       8.90856123e+001+0.00000000e+000j, 8.94579794e+001+0.00000000e+000j,
       8.98217389e+001+0.00000000e+000j, 9.01763784e+001+0.00000000e+000j,
       9.05187824e+001+0.00000000e+000j, 9.08384406e+001+0.00000000e+000j,
       9.11487975e+001+0.00000000e+000j, 9.14495184e+001+0.00000000e+000j,
       9.17403019e+001+0.00000000e+000j, 9.20140666e+001+0.00000000e+000j,
       9.22741450e+001+0.00000000e+000j, 9.25245143e+001+0.00000000e+000j,
       9.27650117e+001+0.00000000e+000j, 9.29954828e+001+0.00000000e+000j,
       9.32092918e+001+0.00000000e+000j, 9.34130297e+001+0.00000000e+000j,
       9.36072163e+001+0.00000000e+000j, 9.37918100e+001+0.00000000e+000j,
       9.39666890e+001+0.00000000e+000j, 9.41276455e+001+0.00000000e+000j])

name="wavelength"
first="ref202203"
odd="trans202203"
file=fct.Openfile(name)
file1=fct.Openfile(first)
file2=fct.Openfile(odd)
a=list(file)
b=list(file1)
c=list(file2)
onde=np.array(a)
ref=np.array(b)
trans=np.array(c)

"""
fig, ax1 = plt.subplots()
plt.grid()
color = 'tab:blue'
ax1.set_xlabel('Wavelength en nm')
ax1.set_ylabel('Réflectance en %', color=color)
ax1.plot(onde,ref,label="ref.exp", color=color)
ax1.plot(onde,R202208simu,linestyle="--",label="ref.simu", color=color)
ax1.tick_params(axis='y', labelcolor=color)
plt.legend(loc='upper left') 
ax2 = ax1.twinx() 

color = 'tab:red'
ax2.set_ylabel('Transmitance en %', color=color) 
ax2.plot(onde,trans,label="trans.exp", color=color)
ax2.plot(onde,T202208simu,linestyle="--",label="trans.simu", color=color)
ax2.tick_params(axis='y', labelcolor=color)
plt.legend(loc='lower right') 
fig.tight_layout()
plt.title("Echantillon 2022-08")
plt.show()
"""


plt.figure("Réflectance")
plt.grid()
plt.xlabel("Longueur d'onde (nm)") ; plt.ylabel("Réflectance en %")
plt.plot(onde,ref,label='ref.exp')
plt.plot(onde,R202208simu,linestyle="--",label='ref.simu')
plt.title("Réflectance 08")
plt.legend() 


plt.figure("Transmitance")
plt.grid()
plt.xlabel("Longueur d'onde (nm)") ; plt.ylabel("Transmitance en %")
plt.plot(onde,trans,label="trans.exp")
plt.plot(onde,T202208simu,linestyle="--",label='trans.simu')
plt.title("Transmitance 08")
plt.legend() 