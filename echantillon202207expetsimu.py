import numpy as np
import matplotlib.pyplot as plt
Wavelength = np.arange(300, 420, 1)
from scipy.integrate import simps
from scipy.interpolate import make_interp_spline
from scipy.ndimage import gaussian_filter1d
from scipy.interpolate import make_interp_spline
from numpy import trapz
import numpy as np
import function as fct


R202207simu=np.array([10.87168419, 10.90295264, 10.93002428, 10.95183977, 10.96751131,
       10.98620729, 11.00592582, 11.02048233, 11.03055343, 11.03646285,
       11.03909673, 11.04032086, 11.04010382, 11.03948097, 11.04097125,
       11.04394621, 11.0500412 , 11.06112121, 11.07594313, 11.09816995,
       11.12645577, 11.16132127, 11.20596264, 11.25612958, 11.31842275,
       11.38679163, 11.46671509, 11.55498588, 11.65337093, 11.76217867,
       11.87972164, 12.00986396, 12.14804976, 12.29993579, 12.45941251,
       12.63337248, 12.81599649, 13.01183245, 13.21828376, 13.43464035,
       13.66452978, 13.89878407, 14.14780028, 14.39648546, 14.6535676 ,
       14.91060286, 15.15929065, 15.40439186, 15.63460718, 15.83122805,
       16.02812971, 16.13847473, 16.23209715, 16.26587431, 16.18768888,
       16.08420063, 15.81222674, 15.45020782, 15.01129163, 14.43884266,
       13.84414667, 13.30286932, 12.97221261, 12.88138717, 13.2343486 ,
       14.05307495, 15.25230896, 16.74818618, 18.37662253, 20.06979111,
       21.55242604, 22.79207367, 23.84544949, 24.54429188, 24.91164432,
       25.05880057, 24.94830235, 24.58254508, 24.05055411, 23.36559445,
       22.58688285, 21.70575189, 20.73493035, 19.76142947, 18.77066657,
       17.73721687, 16.68603776, 15.70258811, 14.71165444, 13.7233502 ,
       12.78368917, 11.90161009, 11.04484477, 10.22081548,  9.4719773 ,
        8.77816036,  8.12848891,  7.52732196,  7.00077284,  6.52978073,
        6.10995066,  5.74292381,  5.43911173,  5.18872534,  4.98781184,
        4.83604387,  4.73407011,  4.67797681,  4.66440297,  4.69183432,
        4.75805727,  4.85795699,  4.9910652 ,  5.15537596,  5.34876819,
        5.56536823,  5.80364501,  6.06347855,  6.34278585,  6.63951901,
        6.94587016,  7.26482225,  7.59505603,  7.93480856,  8.28227593,
        8.63064605])
T202207simu=np.array([0.00000000e+000+0.00000000e+000j, 0.00000000e+000+0.00000000e+000j,
       0.00000000e+000+0.00000000e+000j, 1.16657220e-311+9.91387500e-314j,
       2.44804571e-280+1.88929036e-282j, 3.16021212e-251+2.20640618e-253j,
       3.26997915e-224+2.05669766e-226j, 3.06546116e-199+1.72929241e-201j,
       3.66585295e-176+1.84534346e-178j, 6.16757709e-155+2.75557664e-157j,
       1.93318124e-135+7.61868256e-138j, 1.28998133e-117+4.45430447e-120j,
       2.28934341e-101+6.87320372e-104j, 1.22358533e-086+3.16713830e-089j,
       2.54290457e-073+5.61799014e-076j, 2.41203197e-061+4.49574299e-064j,
       1.16541390e-050+1.80849120e-053j, 3.33565908e-041+4.24305003e-044j,
       6.85282070e-033+7.01004602e-036j, 1.16325976e-025+9.34697405e-029j,
       1.87513636e-019+1.14889880e-022j, 3.14483494e-014+1.41532319e-017j,
       6.52611024e-010+2.04849524e-013j, 1.82706557e-006+3.72293627e-010j,
       8.13663979e-004+9.60014230e-008j, 5.99189547e-002+3.39550881e-006j,
       8.91581542e-001+1.56098912e-005j, 2.76972600e+000+1.67454608e-006j,
       2.79149937e+000+0.00000000e+000j, 2.69565483e+000+0.00000000e+000j,
       2.60022630e+000+0.00000000e+000j, 2.50421584e+000+0.00000000e+000j,
       2.40986741e+000+0.00000000e+000j, 2.31676716e+000+0.00000000e+000j,
       2.22655408e+000+0.00000000e+000j, 2.13958895e+000+0.00000000e+000j,
       2.05623043e+000+0.00000000e+000j, 1.97903110e+000+0.00000000e+000j,
       1.90711352e+000+0.00000000e+000j, 1.84349113e+000+0.00000000e+000j,
       1.78920672e+000+0.00000000e+000j, 1.74266581e+000+0.00000000e+000j,
       1.71565212e+000+0.00000000e+000j, 1.68922657e+000+0.00000000e+000j,
       1.70422958e+000+0.00000000e+000j, 1.71944465e+000+0.00000000e+000j,
       1.78068893e+000+0.00000000e+000j, 1.86603046e+000+0.00000000e+000j,
       1.98704891e+000+0.00000000e+000j, 2.19363487e+000+0.00000000e+000j,
       2.41886052e+000+0.00000000e+000j, 2.81351623e+000+0.00000000e+000j,
       3.29383093e+000+0.00000000e+000j, 3.92967876e+000+0.00000000e+000j,
       4.85369724e+000+0.00000000e+000j, 5.98373690e+000+0.00000000e+000j,
       7.54547393e+000+0.00000000e+000j, 9.56481240e+000+0.00000000e+000j,
       1.21002496e+001+0.00000000e+000j, 1.52174060e+001+0.00000000e+000j,
       1.91067775e+001+0.00000000e+000j, 2.36172362e+001+0.00000000e+000j,
       2.84517374e+001+0.00000000e+000j, 3.41285216e+001+0.00000000e+000j,
       3.96061445e+001+0.00000000e+000j, 4.47099149e+001+0.00000000e+000j,
       5.01705723e+001+0.00000000e+000j, 5.44058861e+001+0.00000000e+000j,
       5.79278709e+001+0.00000000e+000j, 6.15499546e+001+0.00000000e+000j,
       6.40452967e+001+0.00000000e+000j, 6.60126578e+001+0.00000000e+000j,
       6.81666694e+001+0.00000000e+000j, 6.97613940e+001+0.00000000e+000j,
       7.09503153e+001+0.00000000e+000j, 7.23621783e+001+0.00000000e+000j,
       7.36421455e+001+0.00000000e+000j, 7.44779596e+001+0.00000000e+000j,
       7.54839391e+001+0.00000000e+000j, 7.66186192e+001+0.00000000e+000j,
       7.74019779e+001+0.00000000e+000j, 7.82878109e+001+0.00000000e+000j,
       7.92634047e+001+0.00000000e+000j, 8.02385705e+001+0.00000000e+000j,
       8.12293334e+001+0.00000000e+000j, 8.22627831e+001+0.00000000e+000j,
       8.33139622e+001+0.00000000e+000j, 8.42974119e+001+0.00000000e+000j,
       8.52883456e+001+0.00000000e+000j, 8.62766498e+001+0.00000000e+000j,
       8.72163108e+001+0.00000000e+000j, 8.80983899e+001+0.00000000e+000j,
       8.89551552e+001+0.00000000e+000j, 8.97791845e+001+0.00000000e+000j,
       9.05280227e+001+0.00000000e+000j, 9.12218396e+001+0.00000000e+000j,
       9.18715111e+001+0.00000000e+000j, 9.24726780e+001+0.00000000e+000j,
       9.29992272e+001+0.00000000e+000j, 9.34702193e+001+0.00000000e+000j,
       9.38900493e+001+0.00000000e+000j, 9.42570762e+001+0.00000000e+000j,
       9.45608883e+001+0.00000000e+000j, 9.48112747e+001+0.00000000e+000j,
       9.50121882e+001+0.00000000e+000j, 9.51639561e+001+0.00000000e+000j,
       9.52659299e+001+0.00000000e+000j, 9.53220232e+001+0.00000000e+000j,
       9.53355970e+001+0.00000000e+000j, 9.53081657e+001+0.00000000e+000j,
       9.52419427e+001+0.00000000e+000j, 9.51420430e+001+0.00000000e+000j,
       9.50089348e+001+0.00000000e+000j, 9.48446240e+001+0.00000000e+000j,
       9.46512318e+001+0.00000000e+000j, 9.44346318e+001+0.00000000e+000j,
       9.41963550e+001+0.00000000e+000j, 9.39365214e+001+0.00000000e+000j,
       9.36572142e+001+0.00000000e+000j, 9.33604810e+001+0.00000000e+000j,
       9.30541298e+001+0.00000000e+000j, 9.27351777e+001+0.00000000e+000j,
       9.24049440e+001+0.00000000e+000j, 9.20651914e+001+0.00000000e+000j,
       9.17177241e+001+0.00000000e+000j, 9.13693540e+001+0.00000000e+000j])

name="wavelength"
first="ref202207"
odd="trans202207"
file=fct.Openfile(name)
file1=fct.Openfile(first)
file2=fct.Openfile(odd)
a=list(file)
b=list(file1)
c=list(file2)
onde=np.array(a)
ref=np.array(b)
trans=np.array(c)

"""
fig, ax1 = plt.subplots()
plt.grid()
color = 'tab:blue'
ax1.set_xlabel('Wavelength en nm')
ax1.set_ylabel('Réflectance en %', color=color)
ax1.plot(onde,ref,label='ref.exp', color=color)
ax1.plot(onde,R202207simu,linestyle="--",label='ref.simu', color=color)
ax1.tick_params(axis='y', labelcolor=color)
plt.legend() 
plt.legend()
ax2 = ax1.twinx()
color = 'tab:red'
ax2.set_ylabel('Transmitance en %', color=color) 
ax2.plot(onde,trans,label="trans.exp", color=color)
ax2.plot(onde,T202207simu,linestyle="--",label='trans.simu', color=color)
ax2.tick_params(axis='y', labelcolor=color)
plt.legend(loc='lower right')
fig.tight_layout()
plt.title("Echantillon 2022-07")
plt.show()
"""

plt.figure("Réflectance")
plt.grid()
plt.xlabel("Longueur d'onde (nm)") ; plt.ylabel("Réflectance en %")
plt.plot(onde,ref,label='ref.exp')
plt.plot(onde,R202207simu,linestyle="--",label='ref.simu')
plt.title("Réflectance 07")
plt.legend() 


plt.figure("Transmitance")
plt.grid()
plt.xlabel("Longueur d'onde (nm)") ; plt.ylabel("Transmitance en %")
plt.plot(onde,trans,label="trans.exp")
plt.plot(onde,T202207simu,linestyle="--",label='trans.simu')
plt.title("Transmitance 07")
plt.legend() 