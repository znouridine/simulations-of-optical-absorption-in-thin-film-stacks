import numpy as np
import matplotlib.pyplot as plt
Wavelength = np.arange(300, 420, 1)
from scipy.integrate import simps
from scipy.interpolate import make_interp_spline
from scipy.ndimage import gaussian_filter1d
from scipy.interpolate import make_interp_spline
from numpy import trapz
import numpy as np
import function as fct


R202206simu=np.array([10.16672072, 10.1491447 , 10.13166531, 10.11458266, 10.09815793,
       10.08257565, 10.06791646, 10.09659933, 10.13116472, 10.16846443,
       10.20836745, 10.2513733 , 10.29730212, 10.34643195, 10.39923122,
       10.45621029, 10.51790091, 10.58433837, 10.65688752, 10.73563722,
       10.82168979, 10.91503458, 11.01714875, 11.12812417, 11.24910365,
       11.38019977, 11.52236448, 11.67750445, 11.84470024, 12.02587843,
       12.22104577, 12.43127743, 12.65548783, 12.8981285 , 13.15479136,
       13.42776853, 13.71390798, 14.01570001, 14.32893968, 14.65185224,
       14.98091293, 15.3130205 , 15.64422071, 15.96917764, 16.28118406,
       16.57420175, 16.84545791, 17.08856291, 17.29878827, 17.47284406,
       17.60910779, 17.70621068, 17.76575933, 17.79023996, 17.78265365,
       17.744678  , 17.67214225, 17.54905112, 17.34206066, 17.00261274,
       16.48719364, 15.79772753, 15.02480723, 14.36301718, 14.07983814,
       14.42326552, 15.4891051 , 17.152781  , 19.08102981, 20.8790581 ,
       22.21420654, 22.85447157, 22.68299969, 21.67477066, 19.90538787,
       17.53376793, 14.77249077, 11.89695877,  9.24586877,  7.09907727,
        5.6781557 ,  5.1073817 ,  5.39091431,  6.39979546,  7.956506  ,
        9.85276103, 11.88971123, 13.92725347, 15.8525658 , 17.57755889,
       19.07035398, 20.3018022 , 21.2540349 , 21.93496549, 22.34926656,
       22.50954724, 22.4299187 , 22.12853595, 21.62619042, 20.93700452,
       20.08924105, 19.10190618, 17.99630107, 16.80609645, 15.54546126,
       14.25166433, 12.94666244, 11.65750679, 10.41823894,  9.2444809 ,
        8.17070143,  7.20940896,  6.38490233,  5.7072656 ,  5.18727054,
        4.83042391,  4.63682125,  4.60358264,  4.72319025,  4.98436218,
        5.37586454,  5.87958369,  6.48336325,  7.16526077,  7.91418098,
        8.70829138])
T202206simu=np.array([0.00000000e+000+0.00000000e+000j, 0.00000000e+000+0.00000000e+000j,
       0.00000000e+000+0.00000000e+000j, 3.24115313e-313+2.75442783e-315j,
       7.02508993e-282+5.42164498e-284j, 9.53445207e-253+6.65679176e-255j,
       1.05094031e-225+6.61003137e-228j, 9.55036181e-201+5.38756399e-203j,
       1.09716226e-177+5.52297440e-180j, 1.76890474e-156+7.90318876e-159j,
       5.30245469e-137+2.08970159e-139j, 3.37522868e-119+1.16546618e-121j,
       5.69899762e-103+1.71098715e-105j, 2.89029563e-088+7.48126489e-091j,
       5.68826269e-075+1.25669693e-077j, 5.09102257e-063+9.48906535e-066j,
       2.31444593e-052+3.59156098e-055j, 6.22058355e-043+7.91275324e-046j,
       1.19494100e-034+1.22235671e-037j, 1.89260634e-027+1.52073879e-030j,
       2.83546860e-021+1.73729578e-024j, 4.40700358e-016+1.98335827e-019j,
       8.45050817e-012+2.65254878e-015j, 2.17682464e-008+4.43562594e-012j,
       8.90399681e-006+1.05055205e-009j, 5.99855607e-004+3.39928327e-008j,
       8.15321620e-003+1.42747255e-007j, 2.30447388e-002+1.39325973e-008j,
       2.10975232e-002+0.00000000e+000j, 1.84796588e-002+0.00000000e+000j,
       1.61553524e-002+0.00000000e+000j, 1.40963230e-002+0.00000000e+000j,
       1.23135845e-002+0.00000000e+000j, 1.07624497e-002+0.00000000e+000j,
       9.45048455e-003+0.00000000e+000j, 8.34100631e-003+0.00000000e+000j,
       7.43281673e-003+0.00000000e+000j, 6.71106359e-003+0.00000000e+000j,
       6.16429321e-003+0.00000000e+000j, 5.78166068e-003+0.00000000e+000j,
       5.56577549e-003+0.00000000e+000j, 5.52747078e-003+0.00000000e+000j,
       5.69431381e-003+0.00000000e+000j, 6.11906572e-003+0.00000000e+000j,
       6.91884226e-003+0.00000000e+000j, 8.23501716e-003+0.00000000e+000j,
       1.03531249e-002+0.00000000e+000j, 1.37538656e-002+0.00000000e+000j,
       1.92745084e-002+0.00000000e+000j, 2.83854083e-002+0.00000000e+000j,
       4.37284670e-002+0.00000000e+000j, 6.97268277e-002+0.00000000e+000j,
       1.14171689e-001+0.00000000e+000j, 1.90266441e-001+0.00000000e+000j,
       3.18704714e-001+0.00000000e+000j, 5.32127786e-001+0.00000000e+000j,
       8.77407339e-001+0.00000000e+000j, 1.41661666e+000+0.00000000e+000j,
       2.22911683e+000+0.00000000e+000j, 3.41283718e+000+0.00000000e+000j,
       5.05641596e+000+0.00000000e+000j, 7.25834006e+000+0.00000000e+000j,
       1.00862079e+001+0.00000000e+000j, 1.35542371e+001+0.00000000e+000j,
       1.76007913e+001+0.00000000e+000j, 2.20481742e+001+0.00000000e+000j,
       2.66566115e+001+0.00000000e+000j, 3.12340071e+001+0.00000000e+000j,
       3.55486546e+001+0.00000000e+000j, 3.96675537e+001+0.00000000e+000j,
       4.37520097e+001+0.00000000e+000j, 4.79486673e+001+0.00000000e+000j,
       5.24017944e+001+0.00000000e+000j, 5.71768201e+001+0.00000000e+000j,
       6.21813032e+001+0.00000000e+000j, 6.75067385e+001+0.00000000e+000j,
       7.29979563e+001+0.00000000e+000j, 7.84045703e+001+0.00000000e+000j,
       8.32203675e+001+0.00000000e+000j, 8.72901915e+001+0.00000000e+000j,
       9.03998165e+001+0.00000000e+000j, 9.23908813e+001+0.00000000e+000j,
       9.31006955e+001+0.00000000e+000j, 9.28202421e+001+0.00000000e+000j,
       9.17537578e+001+0.00000000e+000j, 9.00920644e+001+0.00000000e+000j,
       8.81023049e+001+0.00000000e+000j, 8.60727465e+001+0.00000000e+000j,
       8.41474342e+001+0.00000000e+000j, 8.24224411e+001+0.00000000e+000j,
       8.09296460e+001+0.00000000e+000j, 7.96981978e+001+0.00000000e+000j,
       7.87459651e+001+0.00000000e+000j, 7.80650345e+001+0.00000000e+000j,
       7.76507334e+001+0.00000000e+000j, 7.74904528e+001+0.00000000e+000j,
       7.75700813e+001+0.00000000e+000j, 7.78714641e+001+0.00000000e+000j,
       7.83738096e+001+0.00000000e+000j, 7.90629955e+001+0.00000000e+000j,
       7.99107590e+001+0.00000000e+000j, 8.08980938e+001+0.00000000e+000j,
       8.20036989e+001+0.00000000e+000j, 8.31939035e+001+0.00000000e+000j,
       8.44545387e+001+0.00000000e+000j, 8.57483357e+001+0.00000000e+000j,
       8.70533376e+001+0.00000000e+000j, 8.83424932e+001+0.00000000e+000j,
       8.95817611e+001+0.00000000e+000j, 9.07555191e+001+0.00000000e+000j,
       9.18292986e+001+0.00000000e+000j, 9.27905910e+001+0.00000000e+000j,
       9.36150977e+001+0.00000000e+000j, 9.42927344e+001+0.00000000e+000j,
       9.48127295e+001+0.00000000e+000j, 9.51695761e+001+0.00000000e+000j,
       9.53631788e+001+0.00000000e+000j, 9.53964174e+001+0.00000000e+000j,
       9.52768098e+001+0.00000000e+000j, 9.50156378e+001+0.00000000e+000j,
       9.46241355e+001+0.00000000e+000j, 9.41204163e+001+0.00000000e+000j,
       9.35166368e+001+0.00000000e+000j, 9.28347392e+001+0.00000000e+000j,
       9.20858190e+001+0.00000000e+000j, 9.12917086e+001+0.00000000e+000j])

name="wavelength"
first="ref202206"
odd="trans202206"
file=fct.Openfile(name)
file1=fct.Openfile(first)
file2=fct.Openfile(odd)
a=list(file)
b=list(file1)
c=list(file2)
onde=np.array(a)
ref=np.array(b)
trans=np.array(c)

"""
fig, ax1 = plt.subplots()
plt.grid()
color = 'tab:blue'
ax1.set_xlabel('Wavelength en nm')
ax1.set_ylabel('Réflectance en %', color=color)
ax1.plot(onde,ref,label='ref.exp', color=color)
ax1.plot(onde,R202206simu,linestyle="--",label='ref.simu', color=color)
ax1.tick_params(axis='y', labelcolor=color)
plt.legend() 
plt.legend()
ax2 = ax1.twinx()
color = 'tab:red'
ax2.set_ylabel('Transmitance en %', color=color) 
ax2.plot(onde,trans,label="trans.exp", color=color)
ax2.plot(onde,T202206simu,linestyle="--",label='trans.simu', color=color)
ax2.tick_params(axis='y', labelcolor=color)
plt.legend(loc='lower right')
fig.tight_layout()
plt.title("Echantillon 2022-06")
plt.show()

"""




plt.figure("Réflectance")
plt.grid()
plt.xlabel("Longueur d'onde (nm)") ; plt.ylabel("Réflectance en %")
plt.plot(onde,ref,label='ref.exp')
plt.plot(onde,R202206simu,linestyle="--",label='ref.simu')
plt.title("Réflectance 06")
plt.legend() 


plt.figure("Transmitance")
plt.grid()
plt.xlabel("Longueur d'onde (nm)") ; plt.ylabel("Transmitance en %")
plt.plot(onde,trans,label="trans.exp")
plt.plot(onde,T202206simu,linestyle="--",label='trans.simu')
plt.title("Transmitance 06")
plt.legend() 