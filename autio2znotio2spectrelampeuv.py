import numpy as np
import matplotlib.pyplot as plt
Wavelength = np.arange(300, 420, 1)
from scipy.integrate import simps
from scipy.ndimage import gaussian_filter1d
from numpy import trapz
import numpy as np
import function as fct

R14=np.array([0.28801254, 0.28759654, 0.28709182, 0.28650017, 0.28582344,
       0.28506402, 0.28422435, 0.28330723, 0.28231571, 0.28125272,
       0.28012149, 0.27894907, 0.27771533, 0.27642334, 0.27507602,
       0.27367576, 0.27222526, 0.27072698, 0.26918424, 0.2676006 ,
       0.26598231, 0.26436316, 0.26272951, 0.26109746, 0.25948649,
       0.25791947, 0.25641996, 0.25500916, 0.25370063, 0.25249633,
       0.25138025, 0.25034991, 0.24931227, 0.24818527, 0.24687111,
       0.24526401, 0.24326425, 0.24079128, 0.23779906, 0.23429155,
       0.23033019, 0.22601339, 0.2215548 , 0.21721661, 0.21330814,
       0.21015594, 0.20807292, 0.20731164, 0.20803803, 0.21029928,
       0.21400215, 0.2189983 , 0.22484525, 0.23113505, 0.23736765,
       0.24310067, 0.24785602, 0.25126057, 0.25296748, 0.25268795,
       0.25028086, 0.24542036, 0.23840565, 0.22937426, 0.21860086,
       0.20652942, 0.19364042, 0.1805777 , 0.16805614, 0.15661139,
       0.14702594, 0.13968031, 0.13496303, 0.13294203, 0.13362291,
       0.1367944 , 0.14211123, 0.14911599, 0.15743633, 0.16646228,
       0.17593099, 0.18531526, 0.19440667, 0.20295447, 0.21073621,
       0.21764246, 0.22355702, 0.22841458, 0.23218479, 0.23485583,
       0.23642509, 0.23702286, 0.23660924, 0.23527117, 0.23304748,
       0.22998876, 0.22619894, 0.22170137, 0.2166068 , 0.21098117,
       0.20488721, 0.19846728, 0.19173657, 0.18480224, 0.17775695,
       0.17067746, 0.16369297, 0.15686336, 0.15026484, 0.14395946,
       0.13805178, 0.13260662, 0.12767894, 0.12333102, 0.11960656,
       0.1165346 , 0.11413731, 0.11241475, 0.11137684, 0.11101238])
T14=np.array([0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j])


R10=np.array([0.11131367, 0.11717703, 0.12392597, 0.13188169, 0.14026454,
       0.14910932, 0.15834705, 0.16797679, 0.17803485, 0.18836862,
       0.19909012, 0.21014166, 0.22145075, 0.23309759, 0.24497485,
       0.25710845, 0.26950856, 0.2820653 , 0.29484536, 0.30779282,
       0.32086715, 0.33406837, 0.34733706, 0.36064787, 0.37395943,
       0.38721317, 0.40036846, 0.41336542, 0.42613661, 0.43862745,
       0.45075457, 0.4624444 , 0.47363172, 0.48418865, 0.49404953,
       0.50309506, 0.51117773, 0.51817582, 0.52389047, 0.52812108,
       0.53061848, 0.53108489, 0.52917915, 0.52451121, 0.5166989 ,
       0.50535137, 0.49024354, 0.47140395, 0.44934805, 0.42530316,
       0.40135138, 0.38026535, 0.36500208, 0.35782738, 0.35956432,
       0.36933246, 0.38480288, 0.40336922, 0.42204984, 0.4386717 ,
       0.45142462, 0.4589005 , 0.46011368, 0.45404876, 0.43990464,
       0.41671031, 0.38365095, 0.34067876, 0.28775676, 0.22751079,
       0.16436229, 0.10618664, 0.06349904, 0.0458308 , 0.05802213,
       0.09731157, 0.15521355, 0.22108645, 0.28692923, 0.34665522,
       0.39849131, 0.44109669, 0.47506816, 0.50105096, 0.51964696,
       0.5317805 , 0.53795436, 0.53855372, 0.53398137, 0.52425478,
       0.50948824, 0.48980951, 0.46507118, 0.43550884, 0.4010679 ,
       0.36190734, 0.31865919, 0.27191859, 0.22309048, 0.17387304,
       0.12647757, 0.08351466, 0.04771456, 0.0215552 , 0.00671687,
       0.00386845, 0.0124986 , 0.03115322, 0.05776343, 0.09010061,
       0.12583521, 0.16299226, 0.20000923, 0.23565109, 0.26908266,
       0.2998688 , 0.32776641, 0.35270113, 0.37467795, 0.39379157])
T10=np.array([0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j,
       0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j])

a4=1-(R10+T10)
a5=1-(R14+T14)
Wavelength = np.arange(300,420, 1)
name="Spectre1"
first="essaielampeuv"
file=fct.Openfile(name)
file1=fct.Openfile(first)
s=list(file)
t=list(file1)
ss=np.array(s)
tt=np.array(t)



tt_smoothed = gaussian_filter1d(tt, sigma=2.5)
g=a4*tt_smoothed

fig, ax1 = plt.subplots()
plt.grid()
color = 'tab:red'
ax1.set_xlabel('Wavelength en nm')
ax1.set_ylabel('absorbance A en %', color=color)
ax1.plot(Wavelength,a5*100,label="Absorbance Au/TiO2 14.0x(2.85;24.71)", color=color)
#ax1.plot(Wavelength,a4*100,'r--',label="TiO2/ZnO 10.0x(30;30)", color=color)
ax1.tick_params(axis='y', labelcolor=color)
plt.legend() 
ax2 = ax1.twinx() 

color = 'tab:blue'
ax2.set_ylabel('Flux de photons en u.a', color=color) 
ax2.plot(Wavelength,tt_smoothed,label="A*LampeUV", color=color)
ax2.tick_params(axis='y', labelcolor=color)

plt.legend() 
fig.tight_layout()
plt.show()